#!/usr/bin/env ruby

# Builds a gnome background rotation xml

require 'builder'

BACKGROUND_DIR = File.expand_path('~/Dropbox/Photos/Wallpapers/dark/')

builder = Builder::XmlMarkup.new(:indent => 2)
out = builder.instruct!
out += builder.background do
   Dir.foreach(BACKGROUND_DIR) do |file|
      path = File.join(BACKGROUND_DIR, file)

      # We don't recurse down and don't include xml files.
      if File.file? path and file.slice(".xml").nil?
         builder.static do
            builder.duration("10")
            builder.file(path)
         end
      end
   end
end

File.open(File.join(BACKGROUND_DIR, "background.xml"), 'w') {|f| f.write(out) }
